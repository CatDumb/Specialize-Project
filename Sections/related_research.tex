%
% This is the TeX file for the related research section
%
\section{RELATED RESEARCH}
\label{section:related_research}

\subsection{Bus-Related Services}

Previous groups' research has investigated traffic-related value-added services, such as nearby hospitals and automatic teller machines (cite that group here). When it comes to our project, one major candidate for us to continue this research direction is the addition of buses and public transport as a whole. Our research investigates a range of existing applications that provide services related to buses. Through a thorough analysis of established solutions within this field, our objective is to acquire insights that will guide the improvement of our application by finding a compromise between the current system's strengths and weaknesses.

The existing solutions in question are the package offered by FPT in the names of Go!Bus TPHCM and the Buyt TPHCM website, as well as BusMap by Phenikaa MaaS JSC.
\subsubsection{The FPT Ecosystem}

Besides Go!Bus TPHCM, FPT offers a wide set of choices for citizens to track traﬀic data, and these services are linked together. Most notably, the TTGT Tp Ho Chi Minh app allows users to see public cameras for traﬀic. We place particular emphasis on Go!Bus as it aligns with our project's focus, and Buyt TPHCM holds significance for data collection, as detailed in subsequent sections. These applications play pivotal roles in informing our research and development efforts.

\paragraph{Go!Bus}

Fundamentally, Go!Bus offers solely bus-related services like bus stop searching, bus route searching, and routing. The app also has some support for Grab when routing. The home screen for the app is as follows:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\textwidth]{assets/images/Research/Bus/gobus_home.png}
    \caption{The home screen for Go!Bus.}
    \label{fig:gobus_homescreen}
\end{figure}

Nevertheless, during our testing of these features, none of them functioned, or had inconsistent uptimes. Here are a few examples of these occurrences.
\begin{figure}[H]
    \centering
    \subfloat[No data for nearby routes.]{
        \includegraphics[width=0.28\linewidth]{assets/images/Research/Bus/gobus_find.png}
        \label{fig:sub1}
    }
    \hspace{0.5cm} % Add a horizontal space of 1cm
    \subfloat[The stops do not show anything when pressed.]{
        \includegraphics[width=0.28\linewidth]{assets/images/Research/Bus/gobus_routes.png}
        \label{fig:sub2}
    }
    \hspace{0.5cm} % Add a horizontal space of 1cm
    \subfloat[Embedded web view with server error.]{
        \includegraphics[width=0.28\linewidth]{assets/images/Research/Bus/gobus_instruction.png}
        \label{fig:sub3}
        }
    \caption{Go!Bus functionalities problems}
\end{figure}

It also portrayed some mobile app bad practices, such as embedding an excessive number of web views into the user interface. Apple, in particular, is not fond of this approach and publicly stated that apps using this will not be accepted in the future \cite{apple_webview}. This is one of the points that we will take into consideration when developing our iOS app.

\paragraph{Buyt TPHCM website}
Buyt TPHCM website is an online resource designed to provide comprehensive information and tools for navigating the public bus system in Ho Chi Minh City. This website aims to enhance the accessibility and user experience of public transportation within the city by offering the following key functionalities:

\begin{itemize}
    \item \textbf{Detailed route information:} The website provides users with comprehensive information on all bus routes in Ho Chi Minh City, including individual stop locations, schedules, and route maps.
    \item \textbf{Real-time bus arrival predictions:} To promote efficient travel planning, buyttphcm.com.vn offers real-time bus arrival predictions for all routes, allowing users to make informed decisions about their travel time.
    \item \textbf{Convenient tools and resources:} This website provides access to the Go!Bus mobile application, enabling users to easily purchase tickets and plan their bus journeys on the go. Additionally, users can find helpful information about the Public Transport Management Center and other relevant resources.
    \item \textbf{Up-to-date news and information:} buyttphcm.com.vn keeps users informed of the latest developments in the Ho Chi Minh City bus system, including temporary route changes, service disruptions, and new initiatives.
\end{itemize}

With its regularly updated resources, Buyt TP HCM will play a crucial role in our data collection process for bus stops and routes in the later stages of our project.

\subsubsection{BusMap}

BusMap rose as a prime solution for city navigation using buses. It also expanded into other regions and countries like Thailand and is overall doing well.

The fundamental bus services like searching and routing are executed well on BusMap, bar some UI lag that could be due to the excessive inclusion of map views. Users can see the bus locations that are coming their way with an estimated time of arrival. There are also other services offered by BusMap, such as JobMap, MotelMap, and driver license support. However, sections like "Blogs" and "News" might be unnecessary for most users.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\textwidth]{assets/images/Research/Bus/busmap_home.png}
    \caption{The home screen for BusMap}
    \label{fig:busmap_homescreen}
\end{figure}

\subsubsection{Conclusion}

Both of these apps share a common feature of being equipped with an abundance of supplementary services. While Go!Bus TPHCM is compatible with Grab, BusMap has diversified its partnerships to include other businesses. One apparent limitation of UTraffic is the lack of access to real-time data, such as the current locations of buses and the duration until the next journey. Nevertheless, with sufficient effort and development, our application can excel as a dependable routing and search engine. Ultimately, the primary function of UTraffic is to process congestion data; therefore, we must be careful not to delve too thoroughly into other domains.

\subsection{HCMUT TrafficView}
HCMUT TrafficView is a project developed by the Ho Chi Minh City University of Technology's students that allow users to view the traffic cameras placed around the city. Via the techniques of data labeling and image processing, the project's product is able to assess the traffic status shown by a traffic camera via the traffic density, condition, and give a recommended velocity. The users can choose to view cameras along a path or an individual one. \cite{hcmut_trafficview} Figure \ref{fig:trafficview_demo} shows a traffic camera near \textit{Hai Thuong Lan Ong - Cau Cha Va} with moderate density, unstable flow of traffic condition, and a recommended velocity of 25 km/h.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{assets/images/Research/trafficview/hcmut_trafficview_demo.png}
    \caption{Demonstration of HCMUT TrafficView.}
    \label{fig:trafficview_demo}
\end{figure}

The core functionalities, as described by the authoring group, include:
\begin{itemize}
    \item Live traffic camera feed: the system allowing users to select a location of interest and view real-time images.
    \item Congestion predictions: the HCMUT TrafficView predicts the density, level of service, and the average vehicle velocity, which was also demonstrated in Figure \ref{fig:trafficview_demo}.
    \item Route optimization: the system calculates and recommends the shortest path between two locations with respect to the real-time traffic conditions.
\end{itemize}

The group used pretrained models to arrive to their conclusions, including Mobilenet (v3\_large), GoogleNet, and Resnet18, with the reference times being 0.01108 second, 0.014 second, and 0.004 second, respectively.

This is a particular useful application that can have a significant impact on the traffic problem of Ho Chi Minh City. Therefore, the addition of HCMUT TrafficView into the UTraffic system and its mobile apps is an impactful and necessary work. We were tasked with supporting the authoring group in integrating their work into the grand system, and meanwhile, we have also developed a UI to see how the traffic camera feed and the traffic status of it would look like. 
\subsection{UTraffic's system analysis and design}

\subsubsection{Current code base structure}

\subsubsection{Implemented APIs}

During our research to improve the performance and coherence of the application, we have developed new API endpoints. They are tailored to work serve two major purposes when it comes to buses, which are the bus routes and the bus stops. The endpoints' description are as follows:
\begin{enumerate}
    \item API endpoints related to bus stops:
    \begin{itemize}
        \item \textbf{Get nearby bus stops}: This endpoint takes in a latitude value, a longitude value, and a radius value in meters. It then returns a list of bus stops that are within the radius of the given location and in the form of GeoJSON.
        \item \textbf{Get nearby disability friendly bus stops}: This endpoint takes the same query paramaters like the nearby bus stops endpoint, but it returns a list of disability friendly bus stops instead.
        \item \textbf{Get the details of a bus stop}: This endpoint takes in a bus stop ID and returns the details of that bus stop.
    \end{itemize}
    \item API endpoints related to bus routes:
    \begin{itemize}
        \item \textbf{Get all bus routes}: This endpoint simply returns all the bus routes in the database to the requesting client. This helps in building a list view for browsing purposes.
        \item \textbf{Get the details of a bus route}: This endpoint takes in a bus route ID and returns the details of that bus route.
        \item \textbf{Get the bus stops along a bus route's path}: This endpoint takes in a bus route ID and the leg, either \textbf{forward} or \textbf{return}. The endpoint then returns the bus stops along that bus route's path, preserving the order of the stops. The response is in the form of GeoJSON.
        \item \textbf{Get the path of a bus route}: This endpoint takes in a bus route ID, and the desired leg and then returns the path of that bus route in the form of GeoJSON.
    \end{itemize}
\end{enumerate}

The details of the API endpoints as well as the deployment efforts that we have done are discussed further in Section \ref{section:implementation}.

We also made changes to the currently deployed API endpoints. At the moment, the endpoint \lstinline{/traffic-status/get-status-v2} receives the query paramaters which are the northeast and southwest bounds of the client's visible map and the zoom level in order to return the appropriate street segments. This endpoint is currently used by the Android app as well as the web version of UTraffic. We have implemented another endpoint, \lstinline{/traffic-status/get-status-v3}, to handle the same functionality but with GeoJSON as the response. This is done by following the GeoJSON's standard format of being a FeatureCollection of Features, where each Feature is a Point with the coordinates of the traffic status. The following is the comparison between the two format when taking a node as an example:

\begin{figure}[H]
    \centering
    \subfloat[The current response format.\label{fig:notgeojson_response}]{%
        \includegraphics[width=0.4\linewidth]{assets/images/Research/API/notgeojson.png}
    }
    \hspace{0.5cm} % Add a horizontal space of 1cm
    \subfloat[The GeoJSON response format.\label{fig:geojson_response}]{%
        \includegraphics[width=0.4\linewidth]{assets/images/Research/API/geojson.png}
    }
    \caption{Comparison between the current response format and the GeoJSON format.}
\end{figure}

GeoJSON helps tremendously when implementing for the iOS app, as it is a standard format that is supported by Apple's MapKit \cite{mkgeojsonobject}. This means that we can easily convert the response into a list of \lstinline{MKAnnotation} and display them on the map without having to parse the original response to dedicated classes, saving development effort and adhering to Apple's best practices.